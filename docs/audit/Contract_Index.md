# Contract Index — Hardstop

Each entry links the documented “contract” to both its narrative source and the concrete implementation/tests that enforce it. Use these references to verify behavior or trace regressions.

| Contract | Guarantee / Scope | Documentation References | Code & Tests |
| --- | --- | --- | --- |
| Deterministic kernel (P0) | Strict mode must yield identical RunRecord + artifact hashes for identical inputs/config; nondeterminism only allowed in declared best-effort runs. | `README.md` “Core Guarantees” + “Run Records in Practice”; `docs/ARCHITECTURE.md#Deterministic-Kernel-Contract`; `docs/EXECUTION_PLAN.md#P0-Verification`. | `src/hardstop/ops/run_record.py`, `src/hardstop/cli.py` (`cmd_fetch`, `cmd_ingest_external`, `cmd_run`, `cmd_brief`), `tests/test_golden_run.py`, `tests/test_demo_pipeline.py`. |
| RunRecord schema & emission | Every operator execution emits schema-valid RunRecords with config hashes, input/output artifact refs, diagnostics. | `docs/specs/run-record.schema.json`; `docs/ARCHITECTURE.md#Storage-&-Provenance`; `docs/EXECUTION_PLAN.md#P0-Verification`. | `src/hardstop/ops/run_record.py` (emitter + hashing), `run_records/` artifacts produced by CLI, `tests/test_run_record.py`, `tests/test_cli_run_records.py`. |
| Exit codes & run status | Pipeline surfaces exit codes `0=HEALTHY`, `1=WARNING`, `2=BROKEN`, with `--strict` promoting warnings to failures; run footer mirrors top issues. | `README.md` “Exit Codes” + “Run Status Footer”; `CHANGELOG.md` `[1.0.0]` Added section; `docs/EXECUTION_PLAN.md#P0-Verification` (strict/best-effort enforcement). | `src/hardstop/ops/run_status.py`, `src/hardstop/cli.py` (`cmd_run`, `cmd_doctor`), `tests/test_run_status.py`, `tests/test_cli_run_records.py`. |
| Source health failure budgets | Tier-aware health scores (`HEALTHY` / `WATCH` / `BLOCKED`), suppression explainers, and gating of strict runs when budgets exhausted. | `README.md` “Source Health Monitoring” + CLI example under “Source health outputs and suppression explanations”; `CHANGELOG.md` `[1.1.0]` Added notes; `docs/EXECUTION_PLAN.md#P1-–-Source-Reliability-&-Health`. | `src/hardstop/ops/source_health.py`, `src/hardstop/database/source_run_repo.py`, CLI `cmd_sources_health` + `cmd_run` gating, `tests/test_source_health.py`, `tests/test_source_health_integration.py`, `tests/test_cli_sources.py`. |
| RunRecord-backed replay | Incident evidence and RunRecords must be hash-verified before replaying incidents; strict mode fails on missing artifacts/mismatched hashes. | `README.md` “Run Records in Practice”; `docs/ARCHITECTURE.md#Run-Record-Provenance-Unit` & incident evidence notes; `docs/EXECUTION_PLAN.md#P2-Verification`. | `src/hardstop/cli.py` (`cmd_incidents_replay`), `src/hardstop/output/incidents/evidence.py`, `tests/test_run_record.py`, `tests/test_output_renderer_only.py`. |

When documenting new claims, cite the relevant doc section(s) above and add companion references to the enforcing modules/tests so audit trails stay reproducible.
